diff -u -Naur frandom-1.2-orig/frandom.c frandom-1.2/frandom.c 
This patch modifies frandom to default to the more secure RC4
varient called RC4-Drop[n], with n=8192.
--- frandom-1.2-orig/frandom.c	2018-02-27 19:23:54.508336443 -0800
+++ frandom-1.2/frandom.c	2018-02-27 19:16:59.586326582 -0800
@@ -45,6 +45,7 @@
 static int frandom_minor = FRANDOM_MINOR;
 static int erandom_minor = ERANDOM_MINOR;
 static int frandom_bufsize = 256;
+static int frandom_drop_n = 8192;   /* RC4-Drop[n]: discard first n bytes of the keystream */
 static int frandom_chunklimit = 0; /* =0 means unlimited */
 
 static struct cdev frandom_cdev;
@@ -60,12 +61,14 @@
 module_param(frandom_minor, int, 0);
 module_param(erandom_minor, int, 0);
 module_param(frandom_bufsize, int, 0);
+module_param(frandom_drop_n, int, 0);       /* Added this module parameter to enable RC4-Drop[n] */
 module_param(frandom_chunklimit, int, 0);
 
 MODULE_PARM_DESC(frandom_major,"Major number of /dev/frandom and /dev/erandom");
 MODULE_PARM_DESC(frandom_minor,"Minor number of /dev/frandom");
 MODULE_PARM_DESC(erandom_minor,"Minor number of /dev/erandom");
 MODULE_PARM_DESC(frandom_bufsize,"Internal buffer size in bytes. Default is 256. Must be >= 256");
+MODULE_PARM_DESC(frandom_drop_n,"Bytes of keystream to discard (RC4-Drop[n]). Default is 8192. ");
 MODULE_PARM_DESC(frandom_chunklimit,"Limit for read() blocks size. 0 (default) is unlimited, otherwise must be >= 256");
 
 struct frandom_state
@@ -170,7 +173,7 @@
 	*/
 
 	i=0; j=0;
-	for (k=0; k<256; k++) {
+	for (k=0; k<frandom_drop_n; k++) {      /* enable RC4-Drop[n] */
 		i = (i + 1) & 0xff;
 		j = (j + S[i]) & 0xff;
 		swap_byte(&S[i], &S[j]);
@@ -313,6 +316,8 @@
 		printk(KERN_ERR "frandom: Refused to load because frandom_bufsize=%d < 256\n",frandom_bufsize);
 		return -EINVAL;
 	}
+    printk(KERN_ERR "frandom: loaded with frandom_drop_n=%d\n", frandom_drop_n);
+    printk(KERN_ERR "frandom: loaded with frandom_bufsize=%d\n", frandom_bufsize);
 	if ((frandom_chunklimit != 0) && (frandom_chunklimit < 256)) {
 		printk(KERN_ERR "frandom: Refused to load because frandom_chunklimit=%d < 256 and != 0\n",frandom_chunklimit);
 		return -EINVAL;
